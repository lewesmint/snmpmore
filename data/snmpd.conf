###########################################################################
#
# snmpd.conf
# Net-SNMP agent configuration file
# See snmpd.conf(5) man page for details
#
###########################################################################
# SECTION: System Information Setup
#

# syslocation: The [typically physical] location of the system.
#   Note that setting this value here means that when trying to
#   perform an snmp SET operation to the sysLocation.0 variable will make
#   the agent return the "notWritable" error code.  IE, including
#   this token in the snmpd.conf file will disable write access to
#   the variable.
#   arguments:  location_string
sysLocation    Sitting on the Dock of the Bay
sysContact     Me <me@example.org>

# sysservices: The proper value for the sysServices object.
#   This is a bitmask indicating which OSI layers this node provides.
#   72 = layers 4 (transport) + 7 (application)
#   arguments:  sysservices_number
sysServices    72



###########################################################################
# SECTION: Agent Operating Mode
#
#   This section defines how the agent will operate when it
#   is running.

# master: Should the agent operate as a master agent or not.
#   Enables AgentX subagent support, allowing other daemons to register
#   their own MIB subtrees with this snmpd instance.
#   arguments: (on|yes|agentx|all|off|no)
master agentx
agentXSocket /var/agentx/master
agentXPerms 0660 0770 Debian-snmp Debian-snmp


# agentaddress: The IP address and port number that the agent will listen on.
#   By default the agent listens to any and all traffic from any
#   interface on the default SNMP port (161).
#   arguments: [transport:]port[@interface/address],...

# Listen on localhost only (most secure, default)
agentaddress  127.0.0.1,[::1]

# Uncomment to listen on all interfaces (required for remote monitoring)
#agentaddress  udp:161,udp6:161

# Uncomment to listen on a specific interface only
#agentaddress  udp:161@192.168.1.10



###########################################################################
# SECTION: View Definitions
#
#   Views define which parts of the MIB tree are accessible.
#   Format: view <name> included|excluded <oid> [mask]
#
#   Multiple 'included' lines for the same view name are cumulative.
#   You can also use 'excluded' to carve out exceptions.
#

#---------------------------------------------------------------------------
# Minimal view - system info only (most restrictive)
#---------------------------------------------------------------------------
# .1.3.6.1.2.1.1 = MIB-2 system group (sysDescr, sysUpTime, sysContact, etc.)
view   systemonly  included   .1.3.6.1.2.1.1

# .1.3.6.1.2.1.25.1 = hrSystem from HOST-RESOURCES-MIB (boot time, uptime, etc.)
view   systemonly  included   .1.3.6.1.2.1.25.1


#---------------------------------------------------------------------------
# Extended view - common monitoring requirements
#---------------------------------------------------------------------------
# Start with system basics
view   extended    included   .1.3.6.1.2.1.1
view   extended    included   .1.3.6.1.2.1.25.1

# Uncomment to add network interface statistics (ifTable, ifXTable)
# .1.3.6.1.2.1.2 = interfaces group - interface counts, speeds, octets in/out
#view   extended    included   .1.3.6.1.2.1.2

# Uncomment to add IF-MIB extensions (64-bit counters, interface names)
# .1.3.6.1.2.1.31 = ifMIB - ifXTable with ifHCInOctets, ifHCOutOctets, ifAlias
#view   extended    included   .1.3.6.1.2.1.31

# Uncomment to add IP statistics and addressing
# .1.3.6.1.2.1.4 = ip group - routing tables, IP addresses, forwarding stats
#view   extended    included   .1.3.6.1.2.1.4

# Uncomment to add TCP connection information
# .1.3.6.1.2.1.6 = tcp group - connection states, open connections, segments
#view   extended    included   .1.3.6.1.2.1.6

# Uncomment to add UDP statistics
# .1.3.6.1.2.1.7 = udp group - datagrams in/out, listener table
#view   extended    included   .1.3.6.1.2.1.7

# Uncomment to add ICMP statistics
# .1.3.6.1.2.1.5 = icmp group - ping stats, errors, messages in/out
#view   extended    included   .1.3.6.1.2.1.5

# Uncomment to add SNMP protocol statistics
# .1.3.6.1.2.1.11 = snmp group - packets in/out, parse errors, bad community names
#view   extended    included   .1.3.6.1.2.1.11


#---------------------------------------------------------------------------
# Host resources view - detailed system information
#---------------------------------------------------------------------------
view   hostresources   included   .1.3.6.1.2.1.1
view   hostresources   included   .1.3.6.1.2.1.25.1

# Uncomment to add storage information (disks, memory, swap)
# .1.3.6.1.2.1.25.2 = hrStorage - disk usage, memory usage, allocation units
#view   hostresources   included   .1.3.6.1.2.1.25.2

# Uncomment to add device inventory
# .1.3.6.1.2.1.25.3 = hrDevice - CPUs, network adapters, storage devices
#view   hostresources   included   .1.3.6.1.2.1.25.3

# Uncomment to add running process list
# .1.3.6.1.2.1.25.4 = hrSWRun - process names, PIDs, CPU/memory per process
#view   hostresources   included   .1.3.6.1.2.1.25.4

# Uncomment to add process performance data
# .1.3.6.1.2.1.25.5 = hrSWRunPerf - CPU ticks and memory per process
#view   hostresources   included   .1.3.6.1.2.1.25.5

# Uncomment to add installed software list
# .1.3.6.1.2.1.25.6 = hrSWInstalled - installed packages and versions
#view   hostresources   included   .1.3.6.1.2.1.25.6


#---------------------------------------------------------------------------
# UCD-SNMP extensions view - Linux-specific metrics
#---------------------------------------------------------------------------
view   ucdsnmp   included   .1.3.6.1.2.1.1

# Uncomment to add memory statistics (Linux-specific, more detail than hrStorage)
# .1.3.6.1.4.1.2021.4 = UCD-SNMP memory - memTotalReal, memAvailReal, memBuffer, memCached
#view   ucdsnmp   included   .1.3.6.1.4.1.2021.4

# Uncomment to add CPU load averages
# .1.3.6.1.4.1.2021.10 = UCD-SNMP laTable - 1, 5, 15 minute load averages
#view   ucdsnmp   included   .1.3.6.1.4.1.2021.10

# Uncomment to add per-CPU statistics
# .1.3.6.1.4.1.2021.11 = UCD-SNMP systemStats - user, system, idle, iowait percentages
#view   ucdsnmp   included   .1.3.6.1.4.1.2021.11

# Uncomment to add disk I/O statistics
# .1.3.6.1.4.1.2021.13 = UCD-SNMP diskIO - reads, writes, bytes per device
#view   ucdsnmp   included   .1.3.6.1.4.1.2021.13

# Uncomment to add custom exec/extend script outputs
# .1.3.6.1.4.1.2021.8 = UCD-SNMP extTable - output from "exec" directives
# .1.3.6.1.4.1.2021.8 = UCD-SNMP extTable - output from "extend" directives
#view   ucdsnmp   included   .1.3.6.1.4.1.2021.8

# Uncomment to add disk space monitoring (from "disk" directives)
# .1.3.6.1.4.1.2021.9 = UCD-SNMP dskTable - configured disk space monitors
#view   ucdsnmp   included   .1.3.6.1.4.1.2021.9

# Uncomment to add process monitoring (from "proc" directives)
# .1.3.6.1.4.1.2021.2 = UCD-SNMP prTable - configured process monitors
#view   ucdsnmp   included   .1.3.6.1.4.1.2021.2


#---------------------------------------------------------------------------
# Full MIB-2 view - all standard SNMP data
#---------------------------------------------------------------------------
# .1.3.6.1.2.1 = entire MIB-2 subtree (iso.org.dod.internet.mgmt.mib-2)
# Includes: system, interfaces, at, ip, icmp, tcp, udp, snmp, host, etc.
#view   mib2   included   .1.3.6.1.2.1


#---------------------------------------------------------------------------
# Full enterprise view - all vendor/implementation-specific data
#---------------------------------------------------------------------------
# .1.3.6.1.4.1 = entire enterprises subtree
# WARNING: May expose sensitive implementation details
# Includes all vendor MIBs: UCD-SNMP, NET-SNMP, plus any hardware vendor MIBs
#view   enterprise   included   .1.3.6.1.4.1


#---------------------------------------------------------------------------
# Complete view - entire MIB tree (least restrictive)
#---------------------------------------------------------------------------
# .1 = everything from iso downwards
# WARNING: Exposes all available SNMP data - use with caution
#view   all   included   .1

# Example: expose everything except sensitive process information
#view   almostall   included   .1
#view   almostall   excluded   .1.3.6.1.2.1.25.4
#view   almostall   excluded   .1.3.6.1.2.1.25.5


#---------------------------------------------------------------------------
# Custom view: system + your AgentX enterprise subtree
#---------------------------------------------------------------------------
# This is the "fix" for your AgentX tree. Your subagent lives under:
#   .1.3.6.1.4.1.99999
# The default "systemonly" view does not include any enterprises OIDs.
view   systemplusagentx  included   .1.3.6.1.2.1.1
view   systemplusagentx  included   .1.3.6.1.2.1.25.1
view   systemplusagentx  included   .1.3.6.1.4.1.99999



###########################################################################
# SECTION: Access Control Setup
#
#   This section defines who is allowed to talk to your running
#   snmp agent.
#

#---------------------------------------------------------------------------
# SNMPv1/v2c communities (simple but insecure - sent in plaintext)
#---------------------------------------------------------------------------

# rocommunity: read-only access
# rwcommunity: read-write access
# Format: [ro|rw]community <string> <source> [-V <view>]
#   source: "default" for any, or network/bits, or specific IP

# Read-only access to systemonly view (default, most restrictive)
#rocommunity  public default -V systemonly
#rocommunity6 public default -V systemonly

# Uncomment for read-only access to extended view
#rocommunity  public default -V extended
#rocommunity6 public default -V extended

# Uncomment for read-only access to host resources
#rocommunity  public default -V hostresources
#rocommunity6 public default -V hostresources

# Uncomment for read-only access to UCD-SNMP extensions
#rocommunity  public default -V ucdsnmp
#rocommunity6 public default -V ucdsnmp

# Uncomment for read-only access to full MIB-2
#rocommunity  public default -V mib2
#rocommunity6 public default -V mib2

# Uncomment for read-only access to entire MIB tree
#rocommunity  public default -V all
#rocommunity6 public default -V all

# Active setting: "public" can see system + your AgentX subtree.
# Kept as "default" because you are bound to localhost above.
# If you later bind to a network interface, restrict "source" accordingly.
rocommunity  public default -V systemplusagentx
rocommunity6 public default -V systemplusagentx

# Uncomment for read-write access (use a different community string!)
# SECURITY WARNING: Restrict rwcommunity to specific networks
#rwcommunity  private 192.168.1.0/24 -V all
#rwcommunity6 private ::1 -V all


#---------------------------------------------------------------------------
# SNMPv3 users (secure - supports authentication and encryption)
#---------------------------------------------------------------------------

# User credentials are stored separately in /var/lib/snmp/snmpd.conf
# Create users with createUser directive in that file:
#   createUser <username> <auth_proto> "<auth_pass>" <priv_proto> "<priv_pass>"
#   auth_proto: MD5, SHA, SHA-224, SHA-256, SHA-384, SHA-512
#   priv_proto: DES, AES, AES-192, AES-256
#
# Example for /var/lib/snmp/snmpd.conf:
#   createUser monitorUser SHA-256 "authPassword123" AES "privPassword456"

# rouser: read-only SNMPv3 access
# rwuser: read-write SNMPv3 access
# Format: [ro|rw]user <username> <security_level> [-V <view>]
#   security_level: noauth, auth, or priv (authpriv)
#     noauth - no authentication (not recommended)
#     auth   - authentication only
#     priv   - authentication and encryption (recommended)

# Read-only v3 user restricted to systemonly (default)
rouser authPrivUser authpriv -V systemonly

# Uncomment for read-only v3 access to full MIB
#rouser monitorUser authpriv -V all

# Uncomment for read-write v3 access to full MIB
#rwuser adminUser authpriv -V all



###########################################################################
# SECTION: Extending the Agent
#
#   Define custom OIDs using exec, extend, or pass directives
#

# extend: Run a script and expose output via NET-SNMP-EXTEND-MIB
# Format: extend <name> <program> [args...]
# Access results at: .1.3.6.1.4.1.8072.1.3.2
#
# Example: expose system temperature
#extend temperature /usr/local/bin/get_temp.sh

# Example: expose custom application status
#extend appstatus /usr/local/bin/check_app.sh

# disk: Monitor disk space (results in UCD-SNMP-MIB dskTable)
# Format: disk <mount_point> <min_free_kb>
#
# Example: alert if root filesystem has less than 10GB free
#disk / 10000000

# proc: Monitor running processes (results in UCD-SNMP-MIB prTable)
# Format: proc <process_name> [max] [min]
#
# Example: ensure sshd is running (at least 1, no max)
#proc sshd



###########################################################################
# SECTION: Include additional configuration
#
# Include all *.conf files from this directory
includeDir /etc/snmp/snmpd.conf.d
